#include <string>
#include <iostream>
#include <fstream>
#include <vector>

using namespace std;
string path = "C:/Users/ygv08/OneDrive/Рабочий стол/txtt.txt";
string user_input = "";
int n = 0;


//вывести
void output() {
	fstream f1(path);
	string cur = "";
	if (f1.is_open()) {
		int stroka = 1;
		while (getline(f1, cur))
		{
			cout << stroka << ") " << cur << "\n";
			stroka++;
		}
	}
	f1.close();
}

//добавить
void input(string s) {
	fstream f2(path, ios::app);
	f2 << s + '\n';
	f2.close();
}

//удалить (номер строки)
void delet(int num) {
	fstream f3(path);
	string cur = "";
	vector <string> new_spi;
	if (f3.is_open()) {
		int stroka = 1;
		while (getline(f3, cur))
		{
			if (stroka != num) {
				new_spi.push_back(cur);
			}
			stroka++;
		}
	}
	f3.close();
	ofstream f4(path, ios::trunc);
	for (auto u : new_spi) {
		f4 << u + '\n';
	}
	f4.close();
}

//удалить всё
void delet_all() {
	ofstream f5(path, ios::trunc);
	f5 << "";
	f5.close();
}

//изменить (номер строки и на что)
void delet(int num, string new_str) {
	fstream f6(path);
	string cur = "";
	vector <string> new_spi;
	if (f6.is_open()) {
		int stroka = 1;
		while (getline(f6, cur))
		{
			if (stroka != num) {
				new_spi.push_back(cur);
			}
			else {
				new_spi.push_back(new_str);
			}
			stroka++;
		}
	}
	f6.close();
	ofstream f7(path, ios::trunc);
	for (auto u : new_spi) {
		f7 << u + '\n';
	}
	f7.close();
}

//помощь по функционалу
void help() {
	cout << " ведите input (тут текст заметки) для создания новой заметки\n ведите del для удаленя строки списка\n ведите del_all для полного удаления заметок\n ведите esc для закрытия программы\n введите redo для перезаписи строки";
}

class Zpisi {
private:
	string fio;
	string phone_number;
	string date;
public:
	Zpisi(string a = "Ivan Ivanih", string b = "+7888888888888", string c = "0.0.0000") {
		fio = a;
		phone_number = b;
		date = c;
		input(fio + " " + phone_number + " " + date);
	}
	~Zpisi() { cout << "object delete"; }
	void out() {
		cout << "\n" << fio << " " << phone_number << " " << date;
	}
	//x = индекс элемента в массиве класса + 1
	void deleit(int x) {
		delet(x);
	}
	void clear() { delet_all(); }
};




int main() {
	setlocale(LC_ALL, "ru");
	help();
	Zpisi* arr = new Zpisi[10];


	while (user_input != "esc") {
		cout << "\n";
		output();
		cout << "\nвведите команду >> ";
		cin >> user_input;
		if (user_input == "help") help();

		else if (user_input == "input")
		{
			cout << "Добавьте заметку (в конце поставьте !)>> ";
			getline(cin, user_input, '!');
			input(user_input);
		}
		else if (user_input == "del") {
			cout << "какую строку удалить >> ";
			cin >> n;
			delet(n);
		}
		else if (user_input == "redo") {
			cout << "какую строку заменить >> ";
			cin >> n;
			cout << "на что (в конце введите !)>> ";
			getline(cin, user_input,'!');
			delet(n, user_input);
		}
		else if (user_input == "del_all") {
			delet_all();
		}
	}

}
